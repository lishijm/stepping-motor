C51 COMPILER V9.60.0.0   SOURCE_0_2                                                        03/17/2021 21:32:13 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE SOURCE_0_2
OBJECT MODULE PLACED IN .\Objects\source_0.2.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE source_0.2.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listing
                    -s\source_0.2.lst) TABS(2) OBJECT(.\Objects\source_0.2.obj)

line level    source

   1          //10KHz定时器，产生5KHz脉冲信号
   2          #include<reg52.h>
   3          #define unchar unsigned char
   4          #define unint unsigned int
   5          sbit pul=P1^0;
   6          sbit dir=P1^1;
   7          sbit en=P1^2;
   8          /*
   9          sbit s1=P3^4;
  10          sbit s2=P3^5;
  11          sbit s3=P3^6;
  12          sbit s4=P3^7;
  13          */
  14          unint temp;
  15          //unint ti;
  16          //unint state,pause;
  17          
  18          void delay(unint delay){
  19   1          unint x,y;
  20   1          for(x=delay;x>0;x--){
  21   2              for(y=255;y>0;y--);
  22   2          }
  23   1      }
  24          /*
  25          void states(){
  26              P3=0Xfe;
  27              temp=P3;
  28              temp=temp&0xf0;
  29              if(temp!=0xf0){
  30                  delay(10);
  31                  if(temp!=0xf0){
  32                      switch(temp){
  33                          case 0xe0:
  34                              pause=0;
  35                              break;
  36                          case 0xd0:
  37                              pause=1;
  38                              break;
  39                          case 0xb0:
  40                              dir=0;
  41                              break;
  42                          case 0x70:
  43                              dir=1;
  44                              break;
  45                      }
  46                  }
  47              }
  48              P3=0Xfd;
  49              temp=P3;
  50              temp=temp&0xf0;
  51              if(temp!=0xf0){
  52                  delay(10);
  53                  if(temp!=0xf0){
  54                      switch(temp){
C51 COMPILER V9.60.0.0   SOURCE_0_2                                                        03/17/2021 21:32:13 PAGE 2   

  55                          case 0xe0:
  56                              state=20;
  57                              break;
  58                          case 0xd0:
  59                              state=10;
  60                              break;
  61                          case 0xb0:
  62                              state=2;
  63                              break;
  64                          case 0x70:
  65                              state=1;
  66                              break;
  67                      }
  68                  }
  69              }
  70          }
  71          
  72          void timer0() interrupt 1{
  73              TH0=(65536-92)/256;
  74              TL0=(65536-92)%256;
  75              ti++;
  76              states();
  77              if(pause==0){
  78                  if(ti==state){
  79                      ti=0;
  80                      pul=~pul;
  81                  }
  82                  else if(ti>=state){
  83                      ti=0;
  84                  }
  85              }
  86          }
  87          */
  88          void encoder() interrupt 0{
  89   1          pul=~pul;
  90   1      }
  91          void main(){
  92   1          /*ti=0;
  93   1          TMOD=0x01;
  94   1          TH0=(65536-92)/256;
  95   1          TL0=(65536-92)%256;
  96   1          */
  97   1          EA = 1;     //开启总中断
  98   1          EX0 = 1;   //开启0号外部中断
  99   1          //ET0=1;
 100   1          IT0 = 1;
 101   1          //TR0=1;
 102   1          pul=0;
 103   1          dir=0;
 104   1          //pause=1;
 105   1          //state=20;
 106   1          while(1);
 107   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     45    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
C51 COMPILER V9.60.0.0   SOURCE_0_2                                                        03/17/2021 21:32:13 PAGE 3   

   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
