C51 COMPILER V9.60.0.0   SOURCE_0_2                                                        03/17/2021 22:17:41 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE SOURCE_0_2
OBJECT MODULE PLACED IN .\Objects\source_0.2.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE source_0.2.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listing
                    -s\source_0.2.lst) TABS(2) OBJECT(.\Objects\source_0.2.obj)

line level    source

   1          #include<reg52.h>
   2          #define unchar unsigned char
   3          #define unint unsigned int
   4          sbit pul=P1^0;
   5          sbit dir=P1^1;
   6          sbit en=P1^2;
   7          unint flag=0;
   8          /*
   9          sbit s1=P3^4;
  10          sbit s2=P3^5;
  11          sbit s3=P3^6;
  12          sbit s4=P3^7;
  13          unint temp;
  14          unint ti;
  15          unint state,pause;
  16          */
  17          void delay(unint delay){
  18   1          unint x,y;
  19   1          for(x=delay;x>0;x--){
  20   2              for(y=255;y>0;y--);
  21   2          }
  22   1      }
  23          /*
  24          void states(){
  25              P3=0Xfe;
  26              temp=P3;
  27              temp=temp&0xf0;
  28              if(temp!=0xf0){
  29                  delay(10);
  30                  if(temp!=0xf0){
  31                      switch(temp){
  32                          case 0xe0:
  33                              pause=0;
  34                              break;
  35                          case 0xd0:
  36                              pause=1;
  37                              break;
  38                          case 0xb0:
  39                              dir=0;
  40                              break;
  41                          case 0x70:
  42                              dir=1;
  43                              break;
  44                      }
  45                  }
  46              }
  47              P3=0Xfd;
  48              temp=P3;
  49              temp=temp&0xf0;
  50              if(temp!=0xf0){
  51                  delay(10);
  52                  if(temp!=0xf0){
  53                      switch(temp){
  54                          case 0xe0:
C51 COMPILER V9.60.0.0   SOURCE_0_2                                                        03/17/2021 22:17:41 PAGE 2   

  55                              state=20;
  56                              break;
  57                          case 0xd0:
  58                              state=10;
  59                              break;
  60                          case 0xb0:
  61                              state=2;
  62                              break;
  63                          case 0x70:
  64                              state=1;
  65                              break;
  66                      }
  67                  }
  68              }
  69          }
  70          
  71          void timer0() interrupt 1{
  72              TH0=(65536-92)/256;
  73              TL0=(65536-92)%256;
  74              ti++;
  75              states();
  76              if(pause==0){
  77                  if(ti==state){
  78                      ti=0;
  79                      pul=~pul;
  80                  }
  81                  else if(ti>=state){
  82                      ti=0;
  83                  }
  84              }
  85          }
  86          */
  87          void encoder_a() interrupt 0{
  88   1          if(flag==0){
  89   2              flag=1;
  90   2          }
  91   1          pul=~pul;
  92   1      }
  93          
  94          void encoder_b() interrupt 2{
  95   1          if(flag==1){
  96   2              dir=1;
  97   2              flag=2;
  98   2          }
  99   1          pul=~pul;
 100   1      }
 101          
 102          void main(){
 103   1          /*ti=0;
 104   1          TMOD=0x01;
 105   1          TH0=(65536-92)/256;
 106   1          TL0=(65536-92)%256;
 107   1          //ET0=1;
 108   1          //TR0=1;
 109   1          */
 110   1          EA=1;     //开启总中断
 111   1          EX0=1;   //开启0号外部中断
 112   1          EX1=1;
 113   1          IT0=1;
 114   1          IT1=1;
 115   1          pul=0;
 116   1          dir=0;
C51 COMPILER V9.60.0.0   SOURCE_0_2                                                        03/17/2021 22:17:41 PAGE 3   

 117   1          //pause=1;
 118   1          //state=20;
 119   1          while(1);
 120   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     86    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
